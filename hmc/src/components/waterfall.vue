<template>
    <div>
        <div class="title">
            <p>美宿种草机</p>
            <p>名宿达人"墙裂"推荐</p>
        </div>
        <div class="main">
            <div class="box">
                <div>
                    <div class="img">
                        <img src="../assets/首页图片/房间样式/timg2.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s</p>
                        <p><span><img src="../assets/max.jpg" alt="">USERNAME</span></p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div>
                    <div class="img">
                        <img  src="../assets/houseimg/房间.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s</p>
                        <p><span><img src="../assets/max.jpg" alt="">USERNAME</span></p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div>
                    <div class="img">
                        <img src="../assets/houseimg/房间2.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s1111111111111</p>
                        <p><span><img src="../assets/max.jpg" alt="">USERNAME</span></p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div>
                    <div class="img">
                        <img src="../assets/首页图片/房间样式/timg.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s</p>
                        <p><span><img src="../assets/max.jpg" alt="">USERNAME</span></p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div>
                    <div class="img">
                        <img src="../assets/houseimg/房间4.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s</p>
                        <p><span><img src="../assets/max.jpg" alt="">USERNAME</span></p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div>
                    <div class="img">
                        <img src="../assets/houseimg/房间5.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s</p>
                        <p><span><img src="../assets/max.jpg" alt="">USERNAME</span></p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div>
                    <div class="img">
                        <img src="../assets/houseimg/房间6.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s</p>
                        <p><span><img src="../assets/max.jpg" alt="">USERNAME</span></p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div>
                    <div class="img">
                        <img src="../assets/houseimg/房间7.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s</p>
                        <p><span><img src="../assets/max.jpg" alt="">USERNAME</span></p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="box">
                <div>
                    <div class="img">
                        <img src="../assets/houseimg/房间8.jpg" alt="">
                        <img src="../assets/首页图片/图标橙色/zufangfenqi.png" alt="">
                    </div>
                    <div class="text">
                        <p><span><img src="../assets/首页图片/图标灰色/location.png" alt="">北京东城区</span></p>
                        <p>11111111111111111111111111s</p>
                        <p>
                            <span><img src="../assets/max.jpg" alt="">USERNAME</span>
                        </p>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>





<style scoped>
    /* 标题索引 */
    .title>p{
        text-align: left;
        padding-left: 8%;
    }
    .title>p:first-child{
        font-size: 20px;
        font-weight: 800;
    }
    .title>p:last-child{
        font-size: 14px;
        font-weight: 400;
        color: #888;
    }
    /* box防止高度坍塌 */
    .clear{
        clear: both;
    }
    /* 大包裹样式 */
    .main{position: relative;
        /* column-count: 2;
        column-gap: 0;} */
        /* display: flex;
        flex-direction: column;
        flex-wrap: wrap;
        height: 1000px; */
        }
    /* main防止高度坍塌 */
    .main::after{
        content: "";
        display: block;
        clear: both;
        height: 0;
        overflow: hidden;
    }
    /* box样式 */
    .box{
    width: 40%;
    padding: 15px 0 0 8.5%;
    position: absolute;
    }

    .box>div{
        border: 1px solid #e8e8e8;
        border-radius: 10px;
        box-shadow: 9px 6px 21px #ccc;
    }
    /*  */

    /* 图片样式 */
    .img{position: relative;}
    .img>img:first-child{width: 100%;height: auto;border-radius: 10px 10px 0 0;}
    /* 图片中小图片样式 */
    /* .img>img:last-child{width: 10%;height: 10%;} */
    .img>img:last-child{position: absolute;right: 5%;top: 5%;}

    /* 文字区域样式 */
    /* 第一行 */
    .text>p:first-child{
        font-size: 10px;
        color: #888;
    }
    .text>p:first-child span{
        display: flex;
        justify-content: left;
        align-items: center;
    }
    .text>p:first-child img{
        width: auto;
    }
    .text::before{
        content: "";
        display: table;
    }
    /* 第二行 */
    .text>p:nth-child(2){
        clear: both;
        text-align: left;
        word-wrap:break-word;
    }
    /* 第三行 */
    .text>p:nth-child(3){
        font-size: 10px;
        line-height: 100%;
    }
    .text>p:nth-child(3) span{
        /* padding-right: 34%; */
        /* float: left; */
        display: flex;
        justify-content: left;
        align-items: center;
    }
    .text>p:nth-child(3) img{
        width: 20%;height: auto;
        border-radius: 50%;
        box-shadow: 0px 0px 5px #ccc;
    }

    /* 解决发定位带来的影响 */
    .main>div:last-child{
        margin-bottom: 50px;
    }
</style>

<script>
export default {
    // 此时不能引用data中的函数
    mounted(){
        window.onload=function waterfall(){
            window.getindex=function(arr,val){
                for(var i=0;i<arr.length;i++){
                    if(arr[i]==val){
                        return i
                    }
                }
            };
            
            // 获取所有box
            var boxs=document.getElementsByClassName('box')
            // 获取主区域
            var main=document.getElementsByClassName('main')[0]
            // 宽
            var boxwidth=boxs[0].offsetWidth;
            // 列
            var cols=Math.floor(document.documentElement.clientWidth/boxwidth)
            // 设置主区域的宽度
            main.style.width=cols*boxwidth+"px";
            // 空数组
            var harr=[];
            for(var i=0;i<boxs.length;i++){
                if(i<cols){
                    boxs[i].style.top="0px";
                    boxs[i].style.left=boxwidth*i+"px"
                    harr.push(boxs[i].offsetHeight);
                    console.log(harr)
                }else{
                    // 获取当前最矮的box及其下标
                    var minheight=Math.min(...harr);
                    var index=this.getindex(harr,minheight);
                    // 为后面的box设置position;
                    boxs[i].style.position='absolute';
                    // 设置高为当前最矮值
                    boxs[i].style.top=minheight+"px";
                    // boxs[i].style.top="212px";
                    // 设置左侧距离
                    boxs[i].style.left=index*boxwidth+"px";
                    // 更新数组中最矮的值
                    harr[index]+=boxs[i].offsetHeight;
                }
            }
        };

    },
    methods:{
        
        //获取最矮的值得index下标
        // getindex(arr,val){
            //     for(var i=0;i<arr.length;i++){
                //         if(arr[i]==val){
                    //             return i
        //         }
        //     }
        // },
        //瀑布流效果
        waterfall(){
            console.log(1)
            window.getindex=function(arr,val){
                for(var i=0;i<arr.length;i++){
                    if(arr[i]==val){
                         return i
                    }
                }
            };
            
            // 获取所有box
            var boxs=document.getElementsByClassName('box')
            console.log(boxs[0])
            // 获取主区域
            var main=document.getElementsByClassName('main')[0]
            // 宽
            var boxwidth=boxs[0].offsetWidth;
            // 列
            var cols=Math.floor(document.documentElement.clientWidth/boxwidth)
            // 设置主区域的宽度
            main.style.width=cols*boxwidth+"px";
            console.log(boxs)
            console.log(boxs[0].offsetHeight);
            console.log(boxs[0].offsetWidth);
            // 空数组
            var harr=[];
            for(var i=0;i<boxs.length;i++){
                if(i<cols){
                    boxs[i].style.top="0px";
                    boxs[i].style.left=boxwidth*i+"px"
                    harr.push(boxs[i].offsetHeight);
                    console.log(harr)
                }else{
                    // 获取当前最矮的box及其下标
                    var minheight=Math.min(...harr);
                    var index=window.getindex(harr,minheight);
                    // 为后面的box设置position;
                    boxs[i].style.position='absolute';
                    // 设置高为当前最矮值
                    boxs[i].style.top=minheight+"px";
                    // boxs[i].style.top="212px";
                    // 设置左侧距离
                    boxs[i].style.left=index*boxwidth+"px";
                    // 更新数组中最矮的值
                    harr[index]+=boxs[i].offsetHeight;
                }
            }
        }
    }
}
</script>